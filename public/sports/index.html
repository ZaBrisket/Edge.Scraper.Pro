<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title>EdgeScraperPro — Sports Scraper</title>
  <link rel="stylesheet" href="/css/brutalist.css"/>
</head>
<body data-mode="pending">
  <a class="skip-link" href="#main">Skip to content</a>
  <header class="site-header"><div class="container header-inner">
    <a class="brand" href="/">EdgeScraperPro</a>
    <button class="nav-toggle" type="button" aria-expanded="false" aria-controls="primary-nav">Menu</button>
    <nav id="primary-nav" class="site-nav" aria-label="Primary">
      <a href="/" data-nav="home">Home</a>
      <a href="/scrape/" data-nav="scrape">Scrape</a>
      <a href="/sports/" data-nav="sports">Sports</a>
      <a href="/companies/" data-nav="companies">Companies</a>
      <a href="/targets/" data-nav="targets">Target Lists</a>
      <a href="/nda/" data-nav="nda">NDA</a>
    </nav>
  </div></header>

  <main id="main" class="container">
    <h1>Sports Scraper</h1>
    <p class="banner">Preconfigured for sports statistics extraction.</p>
    <iframe id="app" class="app-frame" data-loading="true" title="Scraper App (Sports)" src="/scrape/app.html" loading="eager"></iframe>
  </main>

  <footer class="site-footer"><div class="container"><small>Wrapper attempts to auto-select the “Sports” preset.</small></div></footer>

  <script src="/js/frame-bridge.js"></script>
  <script>
    (function(){
      var iframe = document.getElementById('app');
      if(!iframe) return;
      var bridge = new FrameBridge(iframe);
      bridge.listen();

      const lower = function(s){ return String(s || '').toLowerCase(); };

      function clickByText(root, selector, text){
        const target = lower(text);
        return Array.from(root.querySelectorAll(selector)).some(function(node){
          if(lower(node.textContent).includes(target)){
            node.click();
            return true;
          }
          return false;
        });
      }

      function trySelect(doc, label){
        const labelLower = lower(label);
        for(const el of doc.querySelectorAll('.tab')){
          if(lower(el.textContent).includes(labelLower)){
            el.click();
            return true;
          }
        }
        if(clickByText(doc, 'button, a, [role="tab"]', label)) return true;
        for(const l of doc.querySelectorAll('label')){
          if(lower(l.textContent).includes(labelLower)){
            (l.control || l).click();
            return true;
          }
        }
        for(const r of doc.querySelectorAll('input[type="radio"]')){
          const source = lower(`${r.id || ''}${r.name || ''}${r.value || ''}`);
          if(source.includes(labelLower)){
            r.click();
            return true;
          }
        }
        return false;
      }

      iframe.addEventListener('load', function(){
        iframe.removeAttribute('data-loading');
        iframe.removeAttribute('data-error');
        try {
          const win = iframe.contentWindow;
          const doc = win.document;
          const ok = trySelect(doc, 'Sports');
          if(ok){
            bridge.send('SET_MODE', { mode: 'sports' });
            document.body.dataset.mode = 'sports';
          } else {
            document.body.dataset.mode = 'fallback';
          }
        } catch (err) {
          document.body.dataset.mode = 'error';
        }
      });

      iframe.addEventListener('error', function(){
        iframe.setAttribute('data-error', 'true');
        iframe.removeAttribute('data-loading');
        document.body.dataset.mode = 'error';
      });
    })();
  </script>
  <script src="/js/nav.js" defer></script>
</body>
</html>
