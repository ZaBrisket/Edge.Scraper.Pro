<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<title>NDA Reviewer 2.0 — EdgeScraperPro</title>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<meta http-equiv="Content-Security-Policy" content="default-src 'self' data: blob:; script-src 'self'; style-src 'self' 'unsafe-inline'; connect-src 'self'; font-src 'self' data:; img-src 'self' data:;">
<link rel="icon" href="/favicon.ico">
<link rel="stylesheet" href="/assets/css/brutalist.css">
<style>
  body { margin:0; }
  main { padding-bottom:64px; }
  h1 { margin:0 0 8px 0; font-size:28px; }
  .muted { font-size:14px; font-style:italic; }
  .panel { margin:24px 0; }
  .row { display:flex; gap:24px; flex-wrap:wrap; align-items:flex-start; }
  .col { flex:1 1 320px; min-width:320px; }
  textarea { width:100%; min-height:200px; font-family:'Courier New', Courier, monospace; font-size:14px; }
  input[type="file"] { display:block; margin:8px 0 4px 0; }
  .btn { display:inline-flex; gap:8px; align-items:center; }
  .btn.secondary { background:var(--color-paper); color:var(--color-ink); }
  .btn.small { padding:8px 16px; font-size:14px; }
  .btn:disabled { opacity:0.6; cursor:not-allowed; }
  .status { padding:6px 12px; border:1px solid var(--color-ink); font-size:12px; text-transform:uppercase; letter-spacing:1px; display:inline-flex; gap:8px; align-items:center; }
  .status.idle { border-style:dashed; }
  .status.ok { border-style:solid; }
  .status.bad { border-style:double; }
  .issues { max-height:420px; overflow:auto; border:1px solid var(--color-ink); }
  .issue { display:grid; grid-template-columns: 28px 1fr 120px 90px; gap:8px; padding:12px; border-bottom:1px solid var(--color-ink); }
  .issue:last-child { border-bottom:none; }
  .pill { padding:2px 8px; border:1px solid var(--color-ink); font-size:12px; text-transform:uppercase; letter-spacing:1px; display:inline-block; }
  .sev-low { border-style:dotted; }
  .sev-med { border-style:dashed; }
  .sev-high { border-style:solid; font-weight:700; }
  .diff { font-family:'Courier New', Courier, monospace; white-space:pre-wrap; border:1px solid var(--color-ink); padding:16px; }
  del { text-decoration:line-through; }
  ins { text-decoration:underline; }
  .searchbar { display:flex; gap:8px; align-items:center; margin:8px 0;}
  .searchbar input, .searchbar select { padding:8px; border:1px solid var(--color-ink); font:inherit; background:var(--color-paper); }
  .searchbar input { flex:1; }
  .grid { display:grid; grid-template-columns: 1fr 1fr; gap:16px;}
  .small { font-size:12px; }
</style>
</head>
<body>
  <div class="container">
    <div data-component="navigation" data-active="nda"></div>
    <div data-component="error" id="globalError"></div>

    <main>
  <h1>NDA Reviewer 2.0</h1>
  <p class="muted">Upload a <strong>.docx</strong> NDA or paste its text. All analysis runs locally; DOCX parsing and Word export are processed by Netlify Functions. Not legal advice.</p>

  <noscript>
    <div class="panel">
      NDA review requires JavaScript for parsing and exports. Enable JavaScript to continue.
    </div>
  </noscript>

  <div class="panel">
    <div class="row">
      <div class="col">
        <label><strong>Upload .docx</strong> (max <span id="maxMb">5</span> MB)</label>
        <input id="fileInput" type="file" accept=".docx" />
        <button class="btn secondary small" id="parseDocxBtn">Parse .docx</button>
        <div id="uploadStatus" class="muted small">Idle</div>
        <hr/>
        <label for="textInput"><strong>Or paste NDA text</strong></label>
        <textarea id="textInput" placeholder="Paste NDA text here..."></textarea>
        <div style="margin-top:8px;">
          <button class="btn" id="analyzeBtn">Analyze</button>
          <span id="analysisStatus" class="status idle">Idle</span>
        </div>
      </div>
      <div class="col">
        <label><strong>Review Panel</strong></label>
        <div class="searchbar">
          <input id="searchInput" placeholder="Filter by clause type or text..." />
          <select id="severityFilter">
            <option value="all">Severity ≥ All</option>
            <option value="60">Severity ≥ 60</option>
            <option value="80">Severity ≥ 80</option>
          </select>
          <button class="btn secondary small" id="selectAllBtn">Select all</button>
          <button class="btn secondary small" id="selectNoneBtn">None</button>
        </div>
        <div id="issues" class="issues"></div>
        <div style="margin-top:8px; display:flex; gap:8px; align-items:center;">
          <button class="btn" id="applySelectedBtn">Apply Selected</button>
          <button class="btn" id="exportDocxBtn" disabled>Export Redlines (.docx)</button>
          <span id="exportStatus" class="muted small">—</span>
        </div>
      </div>
    </div>
  </div>

  <div class="panel">
    <div class="grid">
      <div>
        <h3>Original</h3>
        <pre id="originalView" class="diff"></pre>
      </div>
      <div>
        <h3>Proposed (preview)</h3>
        <pre id="proposedView" class="diff"></pre>
      </div>
    </div>
  </div>

  <div class="panel">
    <h3>Checklist Compliance</h3>
    <div id="checklistView" class="small muted">Run an analysis to see checklist coverage.</div>
  </div>
</main>
  </div>

<script src="/config.js"></script>
<script src="/components/navigation.js"></script>
<script src="/components/error-handler.js"></script>
<script src="/components/loader.js"></script>
<script src="/nda/policyEngine.browser.js"></script>
<script src="/nda/nda-reviewer.js"></script>
</body>
</html>
