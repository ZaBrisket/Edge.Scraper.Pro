<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>NDA Reviewer 1.0 — EdgeScraperPro</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <!-- CSP tailored for pinned CDNs + ESM workers + WASM -->
  <meta http-equiv="Content-Security-Policy" content="
default-src 'self';
img-src 'self' data:;
style-src 'self' 'unsafe-inline';
connect-src 'self' data:;
script-src 'self' https://cdnjs.cloudflare.com https://cdn.jsdelivr.net https://unpkg.com 'unsafe-eval' 'wasm-unsafe-eval';
worker-src 'self' blob:;
child-src 'self' blob:;
font-src 'self' data:;
object-src 'none';
base-uri 'self';
frame-ancestors 'none';
  ">

  <link rel="stylesheet" href="./nda.css" />
</head>
<body>
  <header class="site-header">
    <nav>
      <a href="/">Scrape</a>
      <a href="/targets">Target Lists</a>
      <span aria-current="page">NDA Reviewer</span>
    </nav>
  </header>

  <main class="container" id="app" aria-busy="false">
    <h1>NDA Reviewer 1.0</h1>
    <div id="app-error" class="alert" role="status" aria-live="polite" hidden></div>
    <p class="disclaimer">
      Reviews inbound NDAs against a configurable playbook. All processing happens locally in your browser.
      <strong>Not legal advice.</strong>
    </p>

    <section class="uploader" aria-label="NDA Text Input">
      <label for="nda-text-input">Paste NDA text here:</label>
      <textarea id="nda-text-input" 
                placeholder="Paste your NDA text here (max 50,000 characters)" 
                maxlength="50000"
                style="width: 100%; min-height: 300px; font-family: monospace; padding: 12px; border: 2px solid #ccc; border-radius: 4px;"></textarea>
      <div class="controls">
        <button id="analyze-btn" class="primary">Analyze</button>
        <span id="text-stats" class="muted"></span>
      </div>
      <div id="progress" class="progress" aria-hidden="true">
        <div id="progress-bar" class="progress-bar" style="width:0%"></div>
        <div id="progress-text" class="progress-text">Idle</div>
      </div>
    </section>

    <section class="filters panel" aria-label="Filters">
      <div class="row">
        <label>Category
          <select id="filter-category">
            <option value="">All</option>
          </select>
        </label>
        <label>Severity ≥
          <input id="filter-severity" type="number" min="1" max="10" value="1" />
        </label>
        <label><input id="filter-blockers" type="checkbox" /> Blockers only</label>
        <input id="filter-text" class="flex" type="search" placeholder="Filter text (title/evidence/recommendation)"/>
      </div>
      <div class="row">
        <label>Playbook
          <select id="playbook-select">
            <option value="edgewater">Edgewater (default)</option>
            <option value="custom">Custom… (import JSON/YAML)</option>
          </select>
        </label>
        <input id="custom-playbook-file" type="file" accept=".json,.yaml,.yml" hidden />
        <button id="export-playbook" class="secondary">Export Current Playbook</button>
        <span id="playbook-meta" class="muted"></span>
      </div>
    </section>

    <section class="panes">
      <div class="pane">
        <h2>Original</h2>
        <pre id="original" class="mono"></pre>
      </div>
      <div class="pane">
        <h2>Redlines</h2>
        <div id="redlines-list" class="redlines-list" aria-live="polite"></div>
        <button id="export-redlines" class="secondary">Export Redlines (.docx)</button>
      </div>
      <div class="pane">
        <h2>Checklist Compliance</h2>
        <div class="table-actions">
          <button id="export-csv">Export Checklist (CSV)</button>
          <button id="export-json">Export Checklist (JSON)</button>
        </div>
        <table id="results" class="results">
          <thead>
            <tr>
              <th>Status</th>
              <th>Category</th>
              <th>Clause</th>
              <th>Title</th>
              <th>Severity</th>
              <th>Evidence</th>
              <th>Recommendation</th>
            </tr>
          </thead>
          <tbody></tbody>
        </table>
        <div class="risk">
          <strong>Overall Risk:</strong> <span id="risk-score">—</span>
          <span id="risk-pill" class="pill"></span>
        </div>
      </div>
    </section>

    <p class="scope">
      Scope: NDA review only. Configurable via playbook (JSON/YAML). Deterministic and explainable checks.
    </p>
  </main>

  <!-- App entry -->
  <script type="module" src="./js/nda.js"></script>
</body>
</html>
